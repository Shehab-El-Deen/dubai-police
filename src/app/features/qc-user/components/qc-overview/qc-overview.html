<div class="dashboard-container">
  <!-- Sidebar -->
  <app-review-sidebar (menuItemSelected)="onMenuItemSelected($event)"></app-review-sidebar>
  <!-- Main Content -->
  @if (currentView === 'overview') {
    <div class="main-content">
      <!-- Header Section -->
      <div class="dashboard-header">
        <div class="header-top">
          <h1 class="dashboard-title">Home Dashboard</h1>
          <span class="last-refresh">Last Refresh: Today, {{ lastRefresh | date: 'short' }}</span>
        </div>
        <!-- <div class="breadcrumb">
          <span>Dashboard</span>
          <span class="breadcrumb-icon">â€º</span>
          <span class="breadcrumb-active">Overview</span>
        </div> -->
      </div>

      <!-- Stats Cards -->
      <app-stats-cards
        [highPriorityValue]="highPriorityCount"
        [needReviewValue]="needReviewCount"
        [topPriorityValue]="topPriorityCount"
      >
      </app-stats-cards>
      <div class="table-section">
        <!-- Search and Filter -->
        <div class="search-filter-section">
          <div class="search-box">
            <input
              type="text"
              placeholder="Search by id or Type"
              [(ngModel)]="searchQuery"
              (input)="onSearch(searchQuery)"
              class="search-input"
            />
            <img class="search-icon" src="svgs/search.svg" width="20" height="20" alt="search" />
          </div>
          <button class="filter-button">
            Filter
                       <img src="svgs/filter-list.svg" width="24" height="24" alt="filter-list" />

          </button>
        </div>

        <!-- Tabs -->
        <app-tab-navigation
          [tabs]="['All Requests', 'Need Review', 'Approved', 'Rejected', 'Validation Failed']"
          (tabChanged)="onTabChange($event)"
        >
        </app-tab-navigation>

        <!-- Request Table -->
        <app-request-table
          [requests]="displayedRequests"
          [currentPage]="currentPage"
          [totalPages]="totalPages"
          [totalItems]="filteredRequests.length"
          [itemsPerPage]="pageSize"
          (nextPage)="nextPage()"
          (prevPage)="prevPage()"
          (rowClick)="onRowClick($event)"
          (viewRequest)="onViewRequest($event)"
        >
        </app-request-table>
      </div>
    </div>
  }

  <!-- Request Detail Modal -->
  <app-request-detail-modal (expandModal)="onModalExpand()"></app-request-detail-modal>

  <!-- Requests Page -->
  @if (
    currentView === 'need-review' ||
    currentView === 'approved' ||
    currentView === 'rejected' ||
    currentView === 'validation-failed' ||
    currentView === 'under-review'
  ) {
    <app-requests-page [selectedTab]="currentView"></app-requests-page>
  }

  <!-- Request Details Page -->
  @if (currentView === 'details' && selectedRequest) {
    <app-request-details-page
      [selectedRequest]="selectedRequest"
      [onClose]="closeDetailsPage"
      (changesDetected)="onDetailsPageChanges($event)"
    ></app-request-details-page>
  }
</div>
