<div class="dashboard-container">
  <!-- Sidebar -->
  <app-business-review-sidebar
    (menuItemSelected)="onMenuItemSelected($event)"
  ></app-business-review-sidebar>
  @if (currentView === 'overview') {
    <div class="main-content">
      <!-- Header Section -->
      <div class="dashboard-header">
        <div class="header-top">
          <h1 class="dashboard-title">Quality Review Dashboard</h1>
          <span class="last-refresh">Last Refresh: Today, {{ lastRefresh | date: 'short' }}</span>
        </div>
        <div class="breadcrumb">
          <span class="breadcrumb-active">Overview</span>
        </div>
      </div>

      <div class="create-request-container">
        <img src="/imgs/create-request.png" alt="Create New Request" class="create-request-image" />
        <div class="create-request-overlay">
          <div class="create-request-content">
            <div class="create-request-text">
              <h2 class="create-request-title">Need to<br /><strong>submit a request?</strong></h2>
              <p class="create-request-description">
                Create and track a new request for quality review.
              </p>
            </div>
            <button class="create-request-btn" (click)="onCreateRequest()">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M8 11.75H16C16.1339 11.75 16.25 11.8661 16.25 12C16.25 12.1339 16.1339 12.25 16 12.25H8C7.86614 12.25 7.75 12.1339 7.75 12C7.75 11.8661 7.86614 11.75 8 11.75Z"
                  fill="#292D32"
                  stroke="#1E7A60"
                />
                <path
                  d="M12 7.75C12.1339 7.75 12.25 7.86614 12.25 8V16C12.25 16.1339 12.1339 16.25 12 16.25C11.8661 16.25 11.75 16.1339 11.75 16V8C11.75 7.86614 11.8661 7.75 12 7.75Z"
                  fill="#292D32"
                  stroke="#1E7A60"
                />
                <path
                  d="M9 1.75H15C17.6576 1.75 19.435 2.31976 20.5576 3.44238C21.6802 4.565 22.25 6.3424 22.25 9V15C22.25 17.6576 21.6802 19.435 20.5576 20.5576C19.435 21.6802 17.6576 22.25 15 22.25H9C6.3424 22.25 4.565 21.6802 3.44238 20.5576C2.31976 19.435 1.75 17.6576 1.75 15V9C1.75 6.3424 2.31976 4.565 3.44238 3.44238C4.565 2.31976 6.3424 1.75 9 1.75ZM9 2.25C6.65972 2.25 4.92459 2.66134 3.79297 3.79297C2.66134 4.92459 2.25 6.65972 2.25 9V15C2.25 17.3403 2.66134 19.0754 3.79297 20.207C4.92459 21.3387 6.65972 21.75 9 21.75H15C17.3403 21.75 19.0754 21.3387 20.207 20.207C21.3387 19.0754 21.75 17.3403 21.75 15V9C21.75 6.65972 21.3387 4.92459 20.207 3.79297C19.0754 2.66134 17.3403 2.25 15 2.25H9Z"
                  fill="#292D32"
                  stroke="#1E7A60"
                />
              </svg>

              Create new request
            </button>
          </div>
        </div>
      </div>

      <div class="table-section">
        <h3 class="requests-title">Requests</h3>
        <!-- Search and Filter -->
        <div class="search-filter-section">
          <div class="search-box">
            <input
              type="text"
              placeholder="Search by id or Type"
              [(ngModel)]="searchQuery"
              (input)="onSearch(searchQuery)"
              class="search-input"
            />
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              class="search-icon"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M13.3891 13.3891L19 19M9.5 15C12.5376 15 15 12.5376 15 9.5C15 6.46243 12.5376 4 9.5 4C6.46243 4 4 6.46243 4 9.5C4 12.5376 6.46243 15 9.5 15Z"
                stroke="#454545"
                stroke-width="1.4"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </div>
          <button class="filter-button">
            Filter
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M4.00024 7H20.0002M7.00018 12H17.0002M11.0002 17H13.0002"
                stroke="#454545"
                stroke-width="1.4"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </button>
        </div>

        <!-- Tabs -->
        <app-business-tab-navigation
          [tabs]="['All Requests', 'Need Review', 'Approved', 'Rejected', 'Validation Failed']"
          (tabChanged)="onTabChange($event)"
        >
        </app-business-tab-navigation>

        <!-- Request Table -->
        <app-business-request-table
          [requests]="displayedRequests"
          [currentPage]="currentPage"
          [totalPages]="totalPages"
          [totalItems]="filteredRequests.length"
          [itemsPerPage]="pageSize"
          (nextPage)="nextPage()"
          (prevPage)="prevPage()"
          (rowClick)="onRowClick($event)"
          (viewRequest)="onViewRequest($event)"
        >
        </app-business-request-table>
      </div>
    </div>
  }

  <!-- Request Detail Modal -->
  <app-business-request-detail-modal (expandModal)="onModalExpand()"></app-business-request-detail-modal>

  <!-- Requests Page -->
  @if (
    currentView === 'need-review' ||
    currentView === 'approved' ||
    currentView === 'rejected' ||
    currentView === 'validation-failed' ||
    currentView === 'under-review'
  ) {
    <app-business-requests-page [selectedTab]="currentView"></app-business-requests-page>
  }

  <!-- Request Details Page -->
  @if (currentView === 'details' && selectedRequest) {
    <app-business-request-details-page
      [selectedRequest]="selectedRequest"
      [onClose]="closeDetailsPage"
    ></app-business-request-details-page>
  }
  @if (currentView === 'create-request') {
    <app-create-request [onClose]="closeCreatePage"></app-create-request>
  }
</div>
